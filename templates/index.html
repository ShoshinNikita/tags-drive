<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Tags Drive</title>
	<!-- CSS -->
	<link rel="stylesheet" type="text/css" media="screen" href="/static/css/main.css" />
	<!-- Material icons  -->
	<link href="/static/fonts/material-icons/material-icons.css" rel="stylesheet">

	<style>
		#top-bar__settings {
			cursor: pointer;
			margin-left: 10px;
			height: 80%;
			width: 30px;
			position: relative;
		}
		#top-bar__settings > img {
			width: 100%;
			position: absolute;
			top: 0; bottom: 0; /* middle */
			margin: auto;
		}
	</style>
</head>

<body onload="Init();">
	<!-- Top bar -->
	<div id="top-bar">
		<!-- Logo -->
		<div id="top-bar__logo">
			<span>Tags Drive</span>
		</div>
		<!-- Search bar -->
		<div id="top-bar__search">
			<div id="top-bar__search__tags">
				<search-tag v-for="tag in pickedTags" :name="tag.name" :color="tag.color"></search-tag>
				<input id="top-bar__search__tag-input" type="text" list="tagsList" v-model="tagForAdding" @keyup.enter="input().tags.add()">
				<datalist id="tagsList">
					<option v-for="tag in sharedState.allTags">{{tag.name}}</option>
				</datalist>
				<i @click="input().tags.add()" class="material-icons" style="cursor: pointer;">add_circle_outline</i>
			</div>
			<div class="vertically" style="border-right: 1px solid black; height: 90%;"></div>
			<div id="top-bar__search__advanced">
				<input v-model="text" type="text" placeholder="Text for search" style="margin-right: 5px;">

				<div class="vertically" style="margin-right: 5px;">Mode</div>
				<select v-model="selectedMode" style="margin-right: 5px;">
					<option>And</option>
					<option>Or</option>
					<option>Not</option>
				</select>
			</div>
			<div style="height: 100%; right: 0px; position: absolute;">
				<i @click="search().usual()" class="material-icons" style="font-size: 37px; cursor: pointer;">search</i>
			</div>
		</div>
		<!-- Settings -->
		<div id="top-bar__settings" class="vertically" @click="settings().tags()">
			<img src="/static/icons/tag.png" title="Change tags">
		</div>
	</div>

	<!-- Main block -->
	<div style="width: 80vw; height: 93vh; overflow: auto; float: right;">
		<div id="main-block"></div>
	</div>

	<!-- Left bar -->
	<div id="left-bar" style="float: left; width: 19vw;">
		<div>
			<ul>
				<li v-for="file in recentFiles" style="overflow-wrap: break-word;">
					{{file.filename}}
				</li>
			</ul>
		</div>
	</div>

	<!-- Upload block -->
	<div id="upload-block" @drop.prevent="upload" @dragover.prevent>
		<div v-if="counter != 0" id="upload-block__layer">
			<div style="display: table; height: 100%; overflow: hidden; margin: auto;">
				<div style="display: table-cell; vertical-align: middle; text-align: center;">
					Upload new files
				</div>
			</div>
		</div>
	</div>

	<!-- Context menu -->
	<div id="context-menu" v-if="show" :style="{'top': top, 'left': left}">
		<div v-on-clickaway="hideMenu">
			<input type="button" class="context-menu__input" @click="changeName" value="Rename">
			<br>
			<input type="button" class="context-menu__input" @click="changeTags" value="Update tags">
			<br>
			<input type="button" class="context-menu__input" @click="changeDescription" value="Update description">
			<br>
			<div class="context-menu__input" style="box-sizing : border-box;" @click="hideMenu">
				<a :href="file.origin" class="context-menu__input--href" download>Download</a>
			</div>
			<input type="button" class="context-menu__input" @click="deleteFile" value="Delete" style="margin-bottom: 0px;">
		</div>
	</div>

	<!-- Modal window -->
	<div id="modal-window" v-if="show" @click.self="hideWindow">
		<div id="modal-window__block">
			<!-- Rename mode -->
			<div v-if="renameMode" class="modal-window__input">
				<div style="margin-bottom: 5px;">Current filename: "{{file.filename}}"</div>
				<input type="text" style="margin-bottom: 5px; width: 400px;" v-model="newFilename" placeholder="New filename">
				<br>
				<input class="btn" type="button" value="Rename" @click="filesAPI().rename()">
			</div>
			<!-- Change tags mode -->
			<div v-else-if="tagsMode" class="modal-window__input">
				<!-- Current tags -->
				<div class="modal-window__tags-field" title="Tags of a file" @drop.prevent="tagsDragAndDrop().addToFile(event)"
				 @dragover.prevent>
					<tags-input v-for="tag in newTags" :name="tag.name" :color="tag.color"></tags-input>
				</div>

				<div style="border-bottom: 1px solid black; width: 90%; margin: 20px auto 20px auto;"></div>

				<!-- All tags -->
				<div class="modal-window__tags-field" title="Unused tags" @drop.prevent="tagsDragAndDrop().delFromFile(event)"
				 @dragover.prevent>
					<tags-input v-for="tag in unusedTags" :name="tag.name" :color="tag.color"></tags-input>
				</div>
				<br>
				<input class="btn" type="button" value="Change tags" @click="filesAPI().updateTags()">
			</div>
			<!-- Change description mode -->
			<div v-else-if="descriptionMode" class="modal-window__input">
				<textarea style="outline: none; margin-bottom: 5px;" placeholder="Current description: empty" readonly="readonly">{{file.description}}</textarea>
				<textarea style="margin-bottom: 5px;" placeholder="New description" v-model="newDescription"></textarea>
				<input class="btn" type="button" value="Update" @click="filesAPI().updateDescription()">
			</div>
			<!-- Delete mode -->
			<div v-else-if="deleteMode" class="modal-window__input">
				<input class="btn deleteBtn" style="height: 50px; width: 100px;" type="button" value="Delete" @click="filesAPI().delete()">
				<input class="btn" style="height: 50px; width: 100px;" type="button" value="Cancel" @click="hideWindow">
			</div>
			<!-- Error -->
			<div v-if="error != ''" id="modal-window__error">Error: {{error}}</div>
		</div>
	</div>

	<!-- Vue -->
	<script src="/static/js/vuejs/vue.min.js"></script>
	<!-- vue-clickaway (https://github.com/simplesmiler/vue-clickaway) -->
	<script src="/static/js/simplesmiler/vue-clickaway.min.js"></script>
	<!-- date.format.js (http://blog.stevenlevithan.com/archives/date-time-format) -->
	<script src="/static/js/stevenlevithan/date.format.js "></script>
	<!-- Custom -->
	<script src="/static/js/components.js "></script>
	<script src="/static/js/main.js "></script>
</body>

</html>